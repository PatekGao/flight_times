# 航班时刻表优化系统使用说明书

## 一、系统概述
本系统是一个完整的航班时刻表优化工具，按照以下顺序执行四个主要任务：
1. 动态时刻表生成（Task1）
2. 预处理任务2数据（pre_task2）
3. 航班配对优化（Task2）
4. 后处理任务2结果（after_task2）

## 二、环境准备
1. Python环境要求：
   - Python 3.x
   - 必要的Python包：
     - gurobipy（优化求解器）
     - pandas
     - numpy

2. 输入文件准备：
   - `python时刻表输入v3.xlsx`：包含原始航班数据(位于utils.py)

## 三、执行流程

### 步骤1：动态时刻表生成（Task1）
1. 运行`task1.py`
   - 输入：`utils读取的输入数据`
   - 输出：`dynamic_sheet.xlsx`
   - 功能：生成优化后的动态时刻表

### 步骤2：预处理任务2数据（pre_task2）
1. 运行`pre_task2.py`
   - 输入：`utils读取的输入数据`
   - 输出：`pre_task2.xlsx`
   - 功能：处理原始航班数据，为任务2准备输入数据

### 步骤3：航班配对优化（Task2）
1. 运行`task2.py`
   - 输入：`pre_task2.xlsx`
   - 输出：`output_flight_pairing.xlsx`
   - 功能：执行航班配对优化

### 步骤4：后处理任务2结果（after_task2）
1. 运行`after_task2.py`
   - 输入：`output_flight_pairing.xlsx`
   - 输出：`final_pairing.xlsx`
   - 功能：对配对结果进行后处理，生成最终结果

## 四、各步骤详细说明

### 1. Task1（动态时刻表生成）
主要参数：
- `num_periods`：时间段数量（288个5分钟时段）
- `max_delta`：相邻时段最大变化量（默认3）
- 各类限制参数（在`utils.py`中定义）：
  - `ARR_LIMIT`：进港限制
  - `DEP_LIMIT`：出港限制
  - `TOT_LIMIT`：总流量限制
  - `ARR_15_LIMIT`：15分钟进港限制
  - `DEP_15_LIMIT`：15分钟出港限制
  - `TOT_15_LIMIT`：15分钟总流量限制

输出：`dynamic_sheet.xlsx`
- 包含5分钟间隔的时刻表
- 显示国内/国际到达和出发航班数量

### 2. pre_task2（预处理）
功能：
- 处理原始航班数据
- 提取到达和出发航班信息
- 生成任务2所需的输入格式

输出：`pre_task2.xlsx`
- 包含到达航班表
- 包含出发航班表

### 3. Task2（航班配对优化）
主要参数：
- 机型分类：C（窄体）、E（宽体）、F（宽体）
- 市场分类：国内（DOM）、国际（INT）
- 配对规则：
  - 同市场配对
  - 混接配对（日期均为2）
- 时间限制：最小过站时间

输出：`output_flight_pairing.xlsx`
- 包含航班配对结果
- 显示配对航班信息和机型

### 4. after_task2（后处理）
功能：
- 处理配对结果
- 生成最终格式的输出
- 可能包含额外的统计和分析

输出：`final_pairing.xlsx`
- 包含最终优化后的航班配对结果

## 五、注意事项
1. 必须按照顺序执行各个步骤
2. 每个步骤的输出文件将作为下一个步骤的输入
3. 确保每个步骤的输出文件格式正确
4. 建议在修改参数后重新执行完整的流程

## 六、常见问题解决
1. 如果某个步骤失败：
   - 检查输入文件是否存在且格式正确
   - 查看错误信息，确认具体问题
   - 检查参数设置是否合理